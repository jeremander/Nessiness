

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

  <!-- Bootstrap -->
  <link rel="stylesheet" type="text/css" href="https://nessiness.com/theme/bootstrap-4/css/bootstrap.min.css">

    <link rel="stylesheet/less" type="text/css" href="https://nessiness.com/theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://nessiness.com/theme/pygments/github.min.css">

  <!-- JQuery -->
  <script src="https://nessiness.com/theme/js/jquery.min.js"></script>

  <!-- Bootstrap -->
  <script src="https://nessiness.com/theme/bootstrap-4/js/bootstrap.bundle.min.js"></script>


  <link rel="stylesheet" type="text/css" href="https://nessiness.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://nessiness.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://nessiness.com/theme/font-awesome/css/solid.css">


    <link href="https://nessiness.com/feed/all.atom.xml" type="application/atom+xml" rel="alternate" title="Nessiness Atom">


    <link rel="apple-touch-icon" href="https://nessiness.com/images/favicons/apple-touch-icon.png" sizes="180x180">
    <link rel="shortcut icon" href="https://nessiness.com/images/favicons/favicon-32x32.png" type="image/png" sizes="32x32">
    <link rel="shortcut icon" href="https://nessiness.com/images/favicons/favicon-16x16.png" type="image/png" sizes="16x16">
    <link rel="manifest" href="https://nessiness.com/images/favicons/site.webmanifest">




<meta name="author" content="Jeremy Silver" />
<meta name="description" content="Introducing fancy_dataclass, a versatile Python library built around dataclasses." />
<meta name="keywords" content="Python">


<meta property="og:site_name" content="Nessiness"/>
<meta property="og:title" content="New Python Library: fancy_dataclass"/>
<meta property="og:description" content="Introducing fancy_dataclass, a versatile Python library built around dataclasses."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://nessiness.com/fancy_dataclass.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2024-10-20 00:00:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://nessiness.com/author/jeremy-silver.html">
<meta property="article:section" content="Python"/>
<meta property="article:tag" content="Python"/>
<meta property="og:image" content="https://nessiness.com/images/logo.png">

  <title>Nessiness &ndash; New Python Library: fancy_dataclass</title>

</head>
<body class="light-theme">
  <nav class="topbar">

  </nav>

  <aside>
    <div>
      <a href="https://nessiness.com">
        <img class="sitelogo" src="https://nessiness.com/images/logo.png" alt="Nessiness" title="Nessiness">
      </a>

      <h1 class="sitetitle">
        <a href="https://nessiness.com">Nessiness</a>
      </h1>
      <h2 class="nessiness-def">n. Random stuff or things.</h2>



      <nav class="nav-links">
        <ul class="list">


            <li>
              <a target="_self" href="https://nessiness.com" >Home</a>
            </li>
            <li>
              <a target="_self" href="https://nessiness.com/pages/projects.html" >Projects</a>
            </li>

              <li>
                <a target="_self"
                   href="https://nessiness.com/pages/about.html">
                  About
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://nessiness.com/pages/links.html">
                  Links
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-twitter" href="https://x.com/NessinessDotCom" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a rel="me" class="sc-mastodon" href="https://mathstodon.xyz/@jeremander" target="_blank">
              <i class="fab fa-mastodon"></i>
            </a>
          </li>
          <li>
            <a  class="sc-github" href="https://github.com/jeremander" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="https://nessiness.com/feed/atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
          <li>
            <a  class="sc-envelope" href="mailto:jeremys@nessiness.com?subject=Nessiness" target="_blank">
              <i class="fas fa-envelope"></i>
            </a>
          </li>
      </ul>


      <!--  -->
    </div>

  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="fancy_dataclass">New Python Library: <i>fancy_dataclass</i></h1>
    <p>
      Posted on Oct 20, 2024 in <a href="https://nessiness.com/category/python.html">Python</a>

    </p>
  </header>


  <div>
    <p>I've written a Python library called <code>fancy_dataclass</code>, a versatile Python library built around dataclasses. Python 3.7 introduced the <a href="https://docs.python.org/3/library/dataclasses.html"><code>dataclasses</code></a> module, which lets you write "statically typed" classes using the type hinting mechanism.</p>
<p>The goal of this library is to enable <em>type-driven development</em>, which leverages the type system to eliminate a lot of boilerplate code. The idea is that you write a dataclass and then imbue with with "special powers." One common use case is to enable automatic conversion of Python objects to and from JSON. Another is to define a bundle of parameters and then expose them to a command-line argument parser. <code>fancy_dataclass</code> makes it possible to do these things with very few lines of code.</p>
<p>I am eager to have people try using it and provide feedback, so please check it out!</p>
<p>To install the library, do: <code>pip install fancy_dataclass</code></p>
<p>It should support Python versions 3.8‚Äì3.12.</p>
<p>üìù Read the documentation <a href="https://fancy-dataclass.readthedocs.io/en/latest/">here</a>.</p>
<p>ü™≤ Submit bug reports or feature requests on <a href="https://github.com/jeremander/fancy-dataclass">Github</a>.</p>
<h3 id="example-1-json-serialization">Example 1: JSON Serialization</h3>
<p>Let's define a dataclass that can be converted to and from JSON.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">fancy_dataclass</span> <span class="kn">import</span> <span class="n">JSONDataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">JSONDataclass</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">hobbies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

<p>Then we can easily convert a <code>Person</code> to a Python dictionary or a JSON string.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># create a Person</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">47</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">71.5</span><span class="p">,</span>
    <span class="n">hobbies</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;reading&#39;</span><span class="p">,</span> <span class="s1">&#39;juggling&#39;</span><span class="p">,</span> <span class="s1">&#39;cycling&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># convert to Python dict</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">person</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
 <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">71.5</span><span class="p">,</span>
 <span class="s1">&#39;hobbies&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;reading&#39;</span><span class="p">,</span> <span class="s1">&#39;juggling&#39;</span><span class="p">,</span> <span class="s1">&#39;cycling&#39;</span><span class="p">]}</span>

<span class="c1"># convert to JSON string</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">person</span><span class="o">.</span><span class="n">to_json_string</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
  <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
  <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mf">71.5</span><span class="p">,</span>
  <span class="s2">&quot;hobbies&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;reading&quot;</span><span class="p">,</span>
    <span class="s2">&quot;juggling&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cycling&quot;</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>It's easy to convert in the other direction, too:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">person</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">from_json_string</span><span class="p">(</span><span class="s1">&#39;{&quot;name&quot;: &quot;John Doe&quot;, &quot;age&quot;: 47, &quot;height&quot;: 71.5, &quot;hobbies&quot;: [&quot;reading&quot;, &quot;juggling&quot;, &quot;cycling&quot;]}&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">person</span>
<span class="n">Person</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">47</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">71.5</span><span class="p">,</span> <span class="n">hobbies</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;reading&#39;</span><span class="p">,</span> <span class="s1">&#39;juggling&#39;</span><span class="p">,</span> <span class="s1">&#39;cycling&#39;</span><span class="p">])</span>
</code></pre></div>

<p><code>fancy_dataclass</code> supports serialization of <a href="https://toml.io/en/">TOML</a> as well as JSON, which is useful for configuration management.</p>
<h3 id="example-2-cli-argument-parsing">Example 2: CLI Argument Parsing</h3>
<p>Let's use <code>fancy_dataclass</code> to write a simple command-line program, <code>greet.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>

<span class="kn">from</span> <span class="nn">fancy_dataclass</span> <span class="kn">import</span> <span class="n">CLIDataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Greet</span><span class="p">(</span><span class="n">CLIDataclass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A program to greet the user.&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;name of person to greet&#39;</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">num_exclamations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-n&#39;</span><span class="p">,</span> <span class="s1">&#39;--num-exclamations&#39;</span><span class="p">],</span>
            <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;number of exclamation points&#39;</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">fancy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;greet fancily&#39;</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># implement your main program logic</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fancy</span><span class="p">:</span>
            <span class="n">greeting</span> <span class="o">=</span> <span class="s1">&#39;Greetings and salutations&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">greeting</span> <span class="o">=</span> <span class="s1">&#39;Hello&#39;</span>
        <span class="n">exclamations</span> <span class="o">=</span> <span class="s1">&#39;!&#39;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_exclamations</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">greeting</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="n">exclamations</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">Greet</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</code></pre></div>

<p>This will create a full-fledged command-line program with argument parsing, without having to write any of it manually. You can view the help menu with:</p>
<div class="highlight"><pre><span></span><code>python greet.py --help
</code></pre></div>

<p>Which prints out:</p>
<div class="highlight"><pre><span></span><code>usage: greet.py [-h] [-n NUM_EXCLAMATIONS] [--fancy] name

A program to greet the user.

positional arguments:
  name                  name of person to greet

options:
  -h, --help            show this help message and exit
  -n NUM_EXCLAMATIONS, --num-exclamations NUM_EXCLAMATIONS
                        number of exclamation points
  --fancy               greet fancily
</code></pre></div>

<p>Note that <code>fancy_dataclass</code> uses the dataclass field metadata to construct the appropriate argument names and help strings for this menu.</p>
<p>Let's try running the program with a few different arguments:</p>
<div class="highlight"><pre><span></span><code>$ python greet.py Bob
Hello, Bob!

$ python greet.py Alice --fancy
Greetings and salutations, Alice!

$ python greet.py Alice --fancy -n 3
Greetings and salutations, Alice!!!

$ python greet.py
usage: greet.py [-h] [-n NUM_EXCLAMATIONS] [--fancy] name
greet.py: error: the following arguments are required: name
</code></pre></div>

<p>We see that dataclass fields with a default value are optional, while those without a default are required.</p>
<h3 id="other-features">Other Features</h3>
<p>In addition to the examples above, <code>fancy_dataclass</code> can do much more, including:</p>
<p><em>Configuration management</em>: store global configurations and use them anywhere in your program
<em>SQL persistence</em>: define SQL tables, and save/load objects from a database
<em>Subprocess calls</em>: generate command-line arguments to be passed to another program</p>
<p>You are free to combine the features together so that the same dataclass can be used for multiple purposes (e.g. both SQL and JSON representation).</p>
<p>There is also a system for adjusting class-specific or field-specific settings (e.g. for JSON serialization, whether to suppress <code>None</code> values or default values); see the documentation for details.</p>
<h3 id="what-about-pydantic">What about <code>pydantic</code>?</h3>
<p>Some of the features in this library, like JSON serialization, are also available in the popular <a href="https://docs.pydantic.dev/latest/">pydantic</a> library. <code>pydantic</code> also provides field <em>validation</em>, which <code>fancy_dataclass</code> does not (yet) do, and a host of other features. On the other hand, <code>fancy_dataclass</code> has features that <code>pydantic</code> does not have, like command-line parsing.</p>
<p>While <code>fancy_dataclass</code> does overlap with <code>pydantic</code> in some ways, it was designed to be as lightweight as possible, both in terms of dependencies and configurations. Another main difference is that <code>pydantic</code> classes must inherit from <code>BaseModel</code> (or use a special <code>pydantic.dataclasses.dataclass</code> decorator), while <code>fancy_dataclass</code> uses the ordinary <code>dataclass</code> decorator with additional "mixin" classes like <code>JSONDataclass</code>, <code>CLIDataclass</code>, etc. depending on what features you want to use.</p>
<p>You can also use both <code>fancy_dataclass</code> and <code>pydantic</code> together to get the best of both worlds.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Anyway, I hope you enjoy using this library, and I am always happy to respond to any bug reports and feature requests! Feel free to follow the project on <a href="https://github.com/jeremander/fancy-dataclass">Github</a> or e-mail me at <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#106;&#101;&#114;&#101;&#109;&#121;&#115;&#64;&#110;&#101;&#115;&#115;&#105;&#110;&#101;&#115;&#115;&#46;&#99;&#111;&#109;">&#106;&#101;&#114;&#101;&#109;&#121;&#115;&#64;&#110;&#101;&#115;&#115;&#105;&#110;&#101;&#115;&#115;&#46;&#99;&#111;&#109;</a>.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://nessiness.com/tag/python.html">Python</a>
    </p>
  </div>





</article>

    <!-- flash messages -->
        <div id="delete-account-success" class="alert flash-alert alert-dismissible alert-danger" style="display: none" role="alert">
      <span class="flash-alert-content"></span>
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

        <div id="delete-account-failure" class="alert flash-alert alert-dismissible alert-danger" style="display: none" role="alert">
      <span class="flash-alert-content"></span>
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

        <div id="password-reset-success" class="alert flash-alert alert-dismissible alert-success" style="display: none" role="alert">
      <span class="flash-alert-content"></span>
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>


    <footer>
<p>&copy; 2024 Nessiness</p>
<p class="footer-pelican">
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p>    </footer>

  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Nessiness ",
  "url" : "https://nessiness.com",
  "image": "https://nessiness.com/images/logo.png",
  "description": ""
}
</script>


  <!-- JS global constants -->
  <script>
    const authUrl = "https://nessiness-auth.fly.dev";

    const isDev = false;
  </script>

  <!-- Local JS imports -->
  <script src="https://nessiness.com/theme/js/utils.js"></script>
  <script src="https://nessiness.com/theme/js/auth.js"></script>
  <script src="https://nessiness.com/theme/js/login.js"></script>
  <script src="https://nessiness.com/theme/js/profile.js"></script>
  <script src="https://nessiness.com/theme/js/main.js"></script>


</body>
</html>